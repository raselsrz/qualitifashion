import{ex as J,a as e,ey as K,ez as Z,eA as X,ae as L,i as v,D as I,I as x,aD as ee,bE as Q,ar as A,B as ne,x as se,at as U,bk as O,b8 as ie,eB as D,as as te,d as f,dj as ae,al as S,eC as oe,ao as re,K as le,ap as pe,aq as ce,cW as Y,aB as de,au as he,e as ue,eD as ge,bf as me,eE as _e,eF as be,c_ as ye,af as fe,eG as Se,ei as ve,y as T,z as C,bS as Me,aj as G,bc as Ee,eH as Pe,eI as Le,aY as z,d3 as V}from"./app.DCvXxO1S.js";import{u as k,B as Oe,D as F}from"./BuyWithPrimeOrderTrackingButton.BxVQMTo5.js";import{E as H}from"./SubscriptionGroupLine.y2PypxcL.js";import{M as De}from"./StackedMerchandisePreview.aoNAB7-b.js";function we({shippingMethods:n,type:s,id:i,displayOnly:a=!1}){const[p]=J(s,i),t=a?n[0]:n.find(({handle:c})=>c===p);return t?e(X.Provider,{value:!0,children:a?e(K,{selectedShippingMethod:t,displayOnly:a}):e(Z,{type:s,methods:n,id:i,isInSplitCartModal:!0})}):null}const E=2;function Ce({merchandise:n,oneTimePurchaseIndex:s,oneTimePurchaseTotalCount:i}){const[a,p]=L(!1),[t,c]=L(!1),o=v(),r=n.length,{totalQuantity:h,firstFiveQuantity:u}=n.reduce((d,m,_)=>{const y=m.quantity??0;return d.totalQuantity+=y,_<E&&(d.firstFiveQuantity+=y),d},{totalQuantity:0,firstFiveQuantity:0}),l=o("shipping.split_shipping_merchandise_quantity_label_standard",{quantity:h},"%{quantity} items"),g=()=>{if(r>E){p(!0);return}c(!0)};return e(ie,{columns:"auto",spacing:"small100",blockAlignment:"center",children:[t?e(H,{merchandise:n}):e(I,{children:[e(x,{spacing:"small300",children:n.slice(0,E).map(d=>e(De,{merchandiseItem:d},d.stableId))}),e(ee,{onPress:g,children:r>E?o("shipping.split_shipping_merchandise_quantity_label_additional",{quantity:h-u},"+%{quantity} more"):o("shipping.split_shipping_merchandise_quantity_label_standard",{quantity:h},"%{quantity} items")})]}),e(Q,{padding:!0,title:e(I,{children:[e(A,{level:1,children:l}),e(ne,{spacing:"small500"}),e(se,{color:"subdued",children:s&&i?o("shipping.split_shipping_merchandise_shipment_number",{number:s,total:i},"Shipment %{number} of %{total}"):o("order_summary.subscriptions","Subscriptions")})]}),open:a,onClose:()=>p(!1),size:"auto",accessibilityLabel:l,children:[e(U,{}),e(O,{padding:["base","none","none","none"],spacing:"small100",children:e(H,{merchandise:n})})]})]})}function Ie({merchandise:n,oneTimePurchaseIndex:s,oneTimePurchaseTotalCount:i}){return D()&&n.length>1?e(Ce,{merchandise:n,oneTimePurchaseIndex:s,oneTimePurchaseTotalCount:i}):e(H,{merchandise:n})}function xe({line:n,oneTimePurchaseIndex:s,oneTimePurchaseTotalCount:i,disableBorders:a=!1,heading:p}){const{id:t,type:c,methods:o,targetMerchandiseLines:r}=n,h=te(r??[]),{background:u,colorLayer:l}=k(),g=D();return e(f,{background:u,colorLayer:l,border:a?"none":"base",cornerRadius:a?"none":"base",padding:"base",children:[p&&e(f,{padding:["none","none","small100","none"],children:e(A,{level:3,children:p})}),e(O,{rows:["auto","fill"],spacing:"small100",padding:"none",children:[e(Ie,{merchandise:h,oneTimePurchaseIndex:s,oneTimePurchaseTotalCount:i}),e(we,{shippingMethods:o,type:c,id:t,displayOnly:g})]})]})}function P({lines:n,heading:s,customNode:i,isSingleCard:a=!1,getSequence:p,showExtendedHeading:t=!1,oneTimePurchaseTotalCount:c}){const o=v(),r=n.length,h=D(),{colorLayer:u}=k();if(!r)return null;const l=n.map((g,d)=>{const m=!!i,_=d+1!==n.length,y=a&&(m||_),M=p(g);return e(I,{children:[e(xe,{line:g,disableBorders:a,heading:(()=>{if(!h)return t&&s?`${o("shipping.split_shipping_shipment_number",{number:M},"Shipment %{number}")} ${oe} ${s}`:o("shipping.split_shipping_shipment_number",{number:M},"Shipment %{number}")})(),oneTimePurchaseIndex:d+1,oneTimePurchaseTotalCount:c},g.id??ae()),y&&e(U,{})]},g.id)});return i&&l.push(i),e(f,{colorLayer:u,children:e(O,{spacing:"small200",rows:"auto",children:a?e(S,{children:e(f,{overflow:"hidden",border:"base",cornerRadius:"base",children:l})}):e(S,{spacing:"large200",children:l})})})}function He({shippingGroupLines:n,oneTimePurchaseTotalCount:s}){const i=v(),a=re(),{name:p}=le(),{buyWithPrimeLines:t,shipsNowLines:c,shipsLaterLines:o}=pe(n),r=ce(n);let h=[...t,...c,...o];r&&(h=[...h,...r.reduce((m,[,_])=>[...m,..._],[])]);const u=m=>h.indexOf(m)+1,l=()=>t.length?i("shipping.split_shipping_shipped_by_shop",{shop_name:p},"Shipped by %{shop_name}"):i("shipping.pre_order_ships_now","Ships now"),g=D(),d=o.length>0||(r?r?.length>0:!1);return e(S,{spacing:"large200",children:[t.length>0&&e(P,{lines:t,getSequence:u,heading:i("split_shipping.shipped_by_amazon_prime","Shipped by Amazon Prime"),oneTimePurchaseTotalCount:s,customNode:g?e(f,{padding:["small100","base"],children:e(Oe,{})}):void 0,isSingleCard:!0,showExtendedHeading:d}),c.length>0&&e(P,{lines:c,getSequence:u,heading:l(),oneTimePurchaseTotalCount:s,showExtendedHeading:d}),o.length>0&&e(P,{lines:o,getSequence:u,heading:i("shipping.pre_order_ships_later","Ships later"),oneTimePurchaseTotalCount:s,showExtendedHeading:d}),r?.map(([m,_])=>_.length>0&&e(P,{lines:_,getSequence:u,heading:i("shipping.pre_order_ships_date",{date:a(new Date(m),{timeZone:"UTC",month:"long",day:"numeric",year:"numeric"})},"Ships %{date}"),oneTimePurchaseTotalCount:s,showExtendedHeading:d},m))]})}function Ae({deliveryLines:n,open:s,onOpen:i,onClose:a}){const p=v(),t=p("shipping.shipping_method_title","Shipping method"),c=Y(),{closeOverlay:o}=de(),r="more-shipping-options-modal";return e(Q,{padding:!0,open:s,title:t,size:"auto",accessibilityLabel:t,blocking:!1,onOpen:()=>{c("moreShippingOptions",{timestamp:new Date,subEvent:"modalOpen"}),i?.()},onClose:async()=>{await a(),c("moreShippingOptions",{timestamp:new Date,subEvent:"modalClose"})},id:r,children:e(S,{spacing:"large200",padding:["none","none","large200","none"],children:[e(He,{shippingGroupLines:n}),e(he,{inlineSize:"fill",onPress:async()=>{o(r),await a(),c("moreShippingOptions",{timestamp:new Date,subEvent:"modalSave"})},children:p("shipping.address_form.save","Save")})]})})}const ke={border:"none"};function Te({deliveryLines:n}){const s=v(),{negotiate:i}=ue(),[a,p]=L(!1),t=ge(),[c,o]=L(!1),{selectedMacro:r,setSelectedMacro:h}=me(),u=Y(),l=_e(),g=be(),{background:d,colorLayer:m}=k(),_=n.every(b=>b.methods.length===1),y=a&&!r,{extensionsBefore:M,extensionsAfter:B}=ye({targeted:!0,hasMultipleDeliveryGroups:!0}),W=()=>{p(!0);const b=i({include:["contactInfo","shippingAddress","merchandiseLines","deliveryNext"],onComplete:()=>{p(!1)}});return o(!1),b};fe(()=>{u("impression",{timestamp:new Date,impressionType:"delivery_macros",impressionFeatures:(t??[]).map(({id:b})=>b)})},[]);const j=async b=>{await h(b),u("deliveryMacroInteraction",{timestamp:new Date,subEvent:"delivery_macros_input_change"})};if(!t?.length)return null;let w;return _?w=e(f,{background:d,colorLayer:m,border:"base",cornerRadius:"base",padding:"none",children:e(F,{selectedDeliveryMethodHandles:Object.values(t[0].deliveryMethodHandles),deliveryLines:n,choiceListContext:!1})}):w=e(Pe,{...l?ke:{},children:e(Se,{variant:"group",name:"delivery-macros",value:r?.id||"",onChange:j,"aria-haspopup":"dialog",groupFooter:e(O,{children:e(ve,{padding:l?["base","none","small300","base"]:"base",inlineAlignment:l?"start":"center",cornerRadius:["none","none","base","base"],appearance:"accent",blockAlignment:"center",onPress:()=>o(!0),overlay:e(Ae,{deliveryLines:n,open:c,onClose:W}),children:e(x,{spacing:"small100",children:[l&&e(T,{source:"plus",appearance:"interactive"}),e(C,{type:l?"generic":"strong",children:s("shipping.split_shipping_more_shipping_options","More shipping options")})]})})}),children:t.map(b=>{const{id:N,title:q,cost:R,costAfterDiscounts:$}=b;return e(Me,{id:N,details:e(F,{selectedDeliveryMethodHandles:Object.values(b.deliveryMethodHandles),deliveryLines:n}),detailsPadding:"none",secondaryContent:y?e(G,{inlineSize:"5ch"}):R.amount!==0&&e(Ee,{cost:R,costAfterDiscounts:$,styleOverrides:{freeTextLetterCase:"uppercase",costSpacing:"none"}}),children:y?e(G,{inlineSize:"12ch",children:q}):e(C,{children:q})},N)})})}),e(S,{spacing:"base",children:[n.length>=Le&&!l&&e(x,{blockAlignment:"center",spacing:"small400",children:[e(T,{source:"truck"}),e(C,{color:"subdued",children:g?s("shipping.split_shipping_multiple_shipment_notice","Your order will arrive in multiple shipments"):s("shipping.split_shipping_multiple_shipment_notice_one_time_purchase",{quantity:n.length},"Your order will arrive in %{quantity} shipments")})]}),g&&e(A,{level:3,children:s("shipping.shipping_method_first_shipment_group_title.other","First shipments")}),e(z,{extensions:M,options:{groupType:V("ONE_TIME_PURCHASE"),includeDeliverySelectionGroups:!_}}),w,e(z,{extensions:B,options:{groupType:V("ONE_TIME_PURCHASE"),includeDeliverySelectionGroups:!_}})]})}export{ke as DELIVERY_MACRO_VAULTED_STYLE_OVERRIDES,Te as default};
