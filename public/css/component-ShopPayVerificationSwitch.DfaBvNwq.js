import{ie as Ue,Q as fe,d7 as Pe,U as xe,K as ve,J as Z,dc as Re,a1 as R,de as ce,df as x,ig as Oe,hL as Be,b5 as _e,ae as A,b1 as I,a4 as Ce,a as _,ih as Fe,Z as M,co as He,ii as $e,af as g,am as ye,ij as We,D as Ie,cq as ze,dm as Ge,ik as qe,aN as Me,il as we,im as Le,io as K,ip as be,dv as le,iq as Y,ir as F,is as Ae,it as $,iu as re,iv as he,bD as J,iw as Ke,ix as ae,iy as Te,iz as je,d6 as Qe,iA as Se,$ as Ye,iB as Je,fO as Ze,i as Xe,f7 as et,iC as tt,iD as nt,iE as De,iF as ot,iG as st,iH as rt,aH as at,iI as Ee}from"./app.DCvXxO1S.js";import{p as H,S as O,A as q,u as it,M as Ne,a as ct}from"./useSubscribeMessenger.DDpYMmRw.js";import{u as ut,a as dt,i as lt,b as Q,c as pe,d as Ve,e as me,f as ft,A as ht,g as pt,r as mt,R as yt,h as ke,j as St,k as Et}from"./index.DENM_spp.js";const kt=e=>{const{alternate:n}=_e(),t=Ue(),o=fe(),{iframe_token:s,redirect_url:l,transaction_params:c}=Pe(),r=xe(),{myshopifyDomain:u}=ve(),{checkoutSessionIdentifier:a}=Z(),i=Re();return R(()=>{if(!a)throw new ce("ShopPayCheckoutIdentifierMissingError::ULCFrame");if(!i||!(s&&l))return;const y=e===x.C1InlineModal?{[Oe]:Be.ShopPayAsPaymentMethod}:null,f={shopify_domain:u,checkout_token:a,origin:e,locale:r,iframe_token:s,redirect_url:l,transaction_params:c,shop_pay_new_signup_login_variant:i,...y};o?.email&&(f.fast_login=!0);const d=Object.entries(f).map(h=>`${encodeURIComponent(h[0])}=${encodeURIComponent(h[1]||"")}`);t&&d.push(t);const m=d.join("&");return`https://${n}/pay/transactions/new/email?${m}`},[e,n,u,a,r,s,l,c,i,t,o])},gt=10;function Pt({x:e,y:n}){const t=window.devicePixelRatio||1;return{x:Math.round(e*t)/t||0,y:Math.round(n*t)/t||0}}function vt(e,n,t,o,{offset:s=0,arrowOffset:l=0}={}){let c={x:0,y:0},r={left:0,right:0},u=0;if(!n&&!t)return{offsets:c,spacing:u};if(!o){const{clientWidth:a,clientHeight:i}=document.documentElement;return c={x:a/2-n/2,y:i/2-t/2},{offsets:c,spacing:u}}switch(e){case"blockEnd":c={x:(document?.dir??"ltr")==="rtl"?o.left:o.right-n,y:o.bottom+s};break;case"inlineEnd":c={x:(document?.dir??"ltr")==="rtl"?o.left-n-s:o.right+s,y:o.top+o.height/2-l};break}return r=_t(c,n),r.right&&!r.left?(c.x+=r.right,u=-10):!r.right&&r.left&&(c.x=0,u=gt),{offsets:c,spacing:u}}function _t(e,n){const t=document.documentElement.clientWidth,o=e.x+n;let s={left:0,right:0};return o>t&&(s={...s,right:t-o}),e.x<0&&(s={...s,left:-e.x}),s}function Ct(){const[e,n]=A(null),t=I(o=>{o!==null&&n(o.getBoundingClientRect())},[]);return[e,t]}function It(e){const[n,t]=A(null),o=I(()=>{e!==null&&t(e.getBoundingClientRect())},[e]);return Ce(()=>(o(),window.addEventListener("resize",o),window.addEventListener("scroll",o),()=>{window.removeEventListener("resize",o),window.removeEventListener("scroll",o)}),[o]),n}const Mt="qdHCv",wt={Popper:Mt};function Lt({children:e,offset:n,arrowOffset:t,contentWidth:o,contentHeight:s,placement:l="inlineEnd",activator:c,open:r}){const u=It(c??null),[a,i]=Ct(),{offsets:p,spacing:y}=R(()=>r?vt(l,(o||a?.width)??0,(s||a?.height)??0,u,{offset:n,arrowOffset:t}):{offsets:{x:0,y:0},spacing:0},[n,t,l,a,u,r,o,s]),{x:f,y:d}=R(()=>r?Pt({x:p.x+y+(window.scrollX||window.pageXOffset),y:p.y+(window.scrollY||window.pageYOffset)}):{x:0,y:0},[p,y,r]),m=R(()=>r?(window.devicePixelRatio||1)<2?`translate(${f}px, ${d}px)`:`translate3d(${f}px, ${d}px, 0)`:"none",[r,f,d]);return _(Fe,{children:_("div",{className:wt.Popper,style:{...a&&{transform:m,MozTransform:m,WebkitTransform:m}},ref:i,"aria-hidden":!r,children:e})})}const bt="hgqpU",At="axmya",Tt="JHj7j",Dt="hQvGd",Nt="PMbsk",Vt="wA8HY",Ut="xnzQ4",U={Backdrop:bt,"Backdrop-visible":"LTbS5",BackdropLinearGradient:At,Popover:Tt,Content:Dt,PopoverArrow:Nt,PopoverOpen:Vt,"Popover-placementInlineEnd":"trTaz","Popover-placementBlockEnd":"KMvI7",Bumper:Ut},xt=ze("Popover");function Rt({children:e,activator:n,open:t,placement:o="inlineEnd",contentWidth:s,contentHeight:l,onClose:c}){const r=M(null),u=M(null),a=M(null),i=He(void 0,xt),p=$e(),y=I(()=>{n?.tagName==="BUTTON"&&(n?.setAttribute("aria-controls",i),n?.setAttribute("aria-expanded",String(t)))},[n,t,i]),f=I(E=>{c?.(E)},[c]),d=I(E=>{E.target instanceof Node&&!n?.contains(E.target)&&document.contains(E.target)&&!a.current?.contains(E.target)&&t&&f(E)},[f,n,t,a]),m=I(E=>{if(t)switch(E.key){case"Escape":case"Esc":f(),n?.focus();break}},[f,n,t]);g(()=>(document.addEventListener("click",d),()=>{document.removeEventListener("click",d)}),[d]),g(()=>(t&&document.addEventListener("keydown",m,!1),()=>{document.removeEventListener("keydown",m,!1)}),[t,m]),g(()=>{y()}),Ce(()=>{t&&a.current?.focus({preventScroll:!0})},[t]);const h=E=>{const v=a.current;if(v){const w=E?Ge(v):qe(v);w?w.focus():v.focus()}},P=ye(U.Popover,U[We("Popover-placement",o)],t&&U.PopoverOpen,n&&U.PopoverArrow);return _(Ie,{children:[_(Lt,{activator:n,placement:o,offset:15,arrowOffset:30,open:t,contentWidth:s,contentHeight:l,children:[t&&_("button",{className:U.Bumper,ref:r,"aria-hidden":"true",onFocus:()=>h(!1)}),_("div",{className:P,id:i,ref:a,children:_("div",{className:U.Content,children:e})}),t&&_("button",{className:U.Bumper,ref:u,"aria-hidden":"true",onFocus:()=>h(!0)})]}),_("div",{className:ye(U.Backdrop,t&&U["Backdrop-visible"],t&&p&&U.BackdropLinearGradient)})]})}const Ot="B1y2m",Bt={VerificationIframe:Ot};var ie=(e=>(e.Normal="normal",e.CustomerAccount="customer_account",e.AccountsSameStore="accounts_same_store",e.AccountsCrossStore="accounts_cross_store",e))(ie||{});function Ft({email:e,skipVerifyOnLoad:n,iframeReady:t,iframeRef:o,dismissedModalKey:s,readyToDismiss:l,onReadyToDismiss:c,showPopover:r,showToggle:u,popoverActivator:a}){const i=fe(),{inMemoryPayPalParts:{accountStatus:p}}=Me(),{guestDismissedModalKey:y}=we(),{checkoutSessionIdentifier:f}=Z(),d=Le(K.ShopPayVerification,{scope:Ae}),m=be().current.token;g(()=>{if(n.current&&t){n.current=!1;return}const v=i&&le(s),w=e&&Y(e),D=p.value.status==="connected",T=i&&Ht();if(!(!t||!w||v||D||T)){if(d.peek()===F.Verified){d.value=void 0;return}H(o?.current,{action:O.Create,email:e,flow:ie.Normal,disableAutoFocus:!!sessionStorage.getItem(y)})}},[e,t]);function h(){if(!f)throw new ce("ShopPayCheckoutIdentifierMissingError::GuestCheckout");i&&le(s)||e&&Y(e)&&(l||c(),m&&H(o?.current,{action:O.CheckoutQueueToken,queueToken:m}),$(ae,escape(f)),re(K.IdentifiedShopPayUser,escape(f)),$(Te,"false"),window.dispatchEvent(new Event("shop_pay_user_identified_cookie_set")),d.value=F.Pending,sessionStorage.getItem(y)?u?.(!0):(r(!0,e),u?.(!1)))}function P(){l&&(d.value=F.Dismissed,i&&$(s,"true"),a?.current?.focus(),r(!1),u?.(!0))}function E(){he(),d.value=F.Verified,J.value="none"}return{onShow:h,onHidden:P,onLoggedIn:E}}function Ht(){const e=sessionStorage.getItem(Ke);if(!e)return!1;const n=Number.parseInt(e,10);return isNaN(n)?!1:Date.now()<n}const $t=[q.FraudGuard,q.InvalidPhone,q.LimitExceeded,q.PhoneBlocked];function Wt({email:e,onSetEmail:n,skipVerifyOnLoad:t,iframeReady:o,iframeRef:s,readyToDismiss:l,onReadyToDismiss:c,showPopover:r,popoverActivator:u,origin:a,open:i}){const{checkoutSessionIdentifier:p}=Z(),{openModal:y}=je(),{exchangeSessionTokenForCookie:f}=it(),d=M(null),m=M(!1),h=Qe(),P=I(()=>{s.current&&H(s.current,{action:O.Create,email:"",flow:ie.Normal})},[s]);g(()=>{s.current&&o&&a===x.C1ModalShopPaySignIn&&(H(s.current,{action:O.AllowNoInitialEmail}),P(),H(s.current,{action:O.Ready}))},[o,s,a,P]),g(()=>{i&&(d.current=null)},[i]),g(()=>{m.current&&s.current&&o&&(m.current=!1,P())}),g(()=>{function S(){n&&(h.updateUserVerification({status:"none"}),n(""),u?.current?.focus()),m.current=!0}return window.addEventListener("shop_pay_verification_reset",S),()=>{window.removeEventListener("shop_pay_verification_reset",S)}},[u,r,n,s,h]),g(()=>{if(!o)return;if(t.current){t.current=!1;return}e&&Y(e)&&a!==x.C1ModalShopPaySignIn?(h.updateUserVerification({email:e,status:"loading"}),H(s?.current,{action:O.Create,email:e,flow:ie.Normal})):a!==x.C1ModalShopPaySignIn&&(P(),h.updateUserVerification({status:"none"}))},[e,o,t,s,a,h,P,r]);function E(){if(!p)throw new ce("ShopPayCheckoutIdentifierMissingError::ShopPayCheckout");a===x.C1ModalShopPay&&e&&Y(e)&&(l||c(),h.updateUserVerification({email:e,status:"found"}),r(!0,e))}function v(){if(a===x.C1ModalShopPay&&!l)return;const S=d.current;n!=null&&S!=null&&(S.status!=="found"||a===x.C1ModalShopPay||!e)&&(n(S.email??""),h.updateUserVerification(S),u?.current?.focus()),h.userVerification.status==="found"?y({type:Se.ContinueWithShopPay,email:h.userVerification.email}):u?.current?.focus(),r(!1),d.current=null}function w(S,L,N){if(!(N&&N!==h.userVerification.email)&&(S===Ne.ShopifyPayUserNotFound&&$t.includes(L)&&(r(!1),y({type:Se.Generic})),N)){const B=L===q.InvalidEmail;h.updateUserVerification({email:N,status:B?"invalid":"new"})}}function D(S,L){S?(d.current||h.userVerification.email!==S)&&(d.current={email:S,status:L?"found":"new"}):d.current={status:"none"}}async function T(S,L){he(),J.value="none",S&&(await f({token:S,origin:a,in_checkout_profile_preview:L}),window.location.reload())}return{onShow:E,onHidden:v,onEmailChange:D,onError:w,onLoggedIn:T}}function zt(e){const n=Ye(),t=M(e),o=t.current,s=e===t.current?void 0:`Callback hook changed from ${t.current.name} to ${e.name} between renders.`;return g(()=>{s&&n.notify(new Je(`${s} Only the original hook is called.`,"ShopPayError::OnlyOriginalHookCalled"),{severity:"warning",errorClass:"ShopPay::ShopPayVerification::useStableHook"})},[s,n]),o}const Gt="shop-pay-verification-iframe",ge=320,qt=300,Kt=1e3;function jt({email:e,onSetEmail:n,open:t,popoverActivator:o,showPopover:s,showToggle:l,urlOrigin:c=x.C1Modal,updatedOrigin:r=c,onIframeLoaded:u}){const a=Ze({base:"blockEnd",medium:"inlineEnd"}),[i,p]=A(!1),[y,f]=A(qt),[d,m]=A(!1),h=Xe(),{checkoutSessionIdentifier:P}=Z(),E=M(null),{alternate:v}=_e(),w=v,[D,T]=A(!1),S=et.flow.value===tt.UnauthenticatedUser,L=nt(e,st),N=`${P}-${e.replace(/[^a-zA-Z0-9]/g,"")}`,B=De(),j=M(B),{onShow:k,onHidden:C,onError:W,onEmailChange:X,onLoggedIn:z}=zt(S?Wt:Ft)({email:L,onSetEmail:n,skipVerifyOnLoad:j,iframeReady:i,iframeRef:E,dismissedModalKey:N,readyToDismiss:d,onReadyToDismiss:()=>{setTimeout(()=>m(!0),Kt)},showPopover:s,showToggle:l,popoverActivator:o,origin:r,open:t});ct({hostname:w,targetId:c,onReady:k,onClosed:ue,onLoggedIn:z,onHidden:C,onError:de,onResized:te,onLoaded:()=>{p(!0),u()},onEmailChange:X}),g(()=>{H(E?.current,{action:O.OriginChanged,origin:r})},[r]),g(()=>{const V=t?O.Ready:O.Hidden;H(E?.current,{action:V}),J.value=t?"shopPayVerification":"none",E.current&&t&&E.current.focus()},[t]);const b=kt(c);if(g(()=>()=>{p(!1)},[b]),!b)return null;const ee=t?o?.current:void 0;return _(Rt,{activator:ee,open:t,onClose:C,placement:a,contentWidth:ge,contentHeight:y,children:_(ot,{active:D||!i,size:"large",children:_("iframe",{id:Gt,title:h("shop_pay.verification.title","Shop Pay Quick Checkout"),ref:E,src:b,height:y,width:ge,className:Bt.VerificationIframe,allow:"publickey-credentials-get *",referrerPolicy:"origin"},b)})});function te(V){!isNaN(V)&&V&&f(V)}function ue(){T(!0)}function de(V,ne,oe){W?.(V,ne,oe),V===Ne.ShopifyPayUserNotFound&&($(ae,"false"),re(K.IdentifiedShopPayUser,"false")),$(Te,ne===q.LimitExceeded?P||"":"false"),window.dispatchEvent(new Event("shop_pay_user_identified_cookie_set"))}}function Qt(e){const{element:n}=ut(),{loading:t}=dt();g(()=>{if(!(!n||t!==!1))return Object.entries(e).forEach(([o,s])=>{n.addEventListener(o,s)}),n?._eventListenerReadyPromiseResolve(),()=>{Object.entries(e).forEach(([o,s])=>{n?.removeEventListener(o,s)})}},[n,t,e])}function Yt(){if(!lt())return;const e="shop-pay-safari-unzoom",n=Q.getElementById(e);if(n)return n.focus();const t=Q.createElement("input");t.id=e,t.style.fontSize="16px",t.style.width="1px",t.style.height="1px",t.style.position="fixed",t.style.bottom="-1000px",t.style.right="-1000px",t.style.transform="translate(1000px, 1000px)",t.setAttribute("aria-hidden","true"),Q.body.appendChild(t),t.focus({preventScroll:!0})}const Jt=100;function Zt({emailInputSelector:e}){const[n,t]=A(),[o,s]=A();return g(()=>{function c(r){this.type==="password"?s(r.timeStamp):t(r.timeStamp)}if(e){const r=Q.querySelector(e);if(r){r.addEventListener("input",c);const u=r.form?.querySelector('input[type="password"]');return u&&u instanceof HTMLInputElement&&u.addEventListener("input",c),()=>{r.removeEventListener("input",c),u&&u.removeEventListener("input",c)}}}},[e]),{isFilledWithPasswordManager:R(()=>n===void 0||o===void 0?!1:Math.abs(n-o)<Jt,[n,o])}}function Xt({autoOpen:e,email:n,emailInputSelector:t,hideChange:o,iframeRef:s,shouldListen:l=!0}){const{autoOpened:c,loaded:r,modalVisible:u,sessionDetected:a}=pe(),{leaveBreadcrumb:i,notify:p}=Ve(),{trackUserAction:y}=me(),{isFilledWithPasswordManager:f}=Zt({emailInputSelector:t}),d=M(null),[m,h]=A(),[P,E]=A(),[v,w]=A(),D=M(null),T=M(""),S=R(()=>new Set,[]),L=()=>T.current,N=I(async(k,C="",W="")=>{const X=ft(k);if(f&&!S.has("PASSWORD_MANAGER_AUTOFILL_DETECTED")&&(S.add("PASSWORD_MANAGER_AUTOFILL_DETECTED"),y({userAction:"PASSWORD_MANAGER_AUTOFILL_DETECTED"})),X&&!S.has("EMAIL_ENTERED")&&(S.add("EMAIL_ENTERED"),y({userAction:"EMAIL_ENTERED"})),i("email entered",{},"state"),!s.current||u||r&&a&&e&&!c)return;const z=X?k:"";d.current&&!d.current?.signal.aborted&&d.current.abort(),d.current=new AbortController;try{const{open:b,postMessage:ee,waitForMessage:te}=s.current;T.current=z,ee({firstName:C,lastName:W,type:"namesubmitted"}),ee({email:z,hideChange:o===void 0?z.length>0:o,type:"emailsubmitted"}),i("email submitted",{email:z?"redacted":""},"state");const ue=te("shop_user_matched",d.current.signal),de=new Promise((V,ne)=>{const oe=async()=>{try{const se=await te("error",d.current.signal);se.type==="error"&&se.code==="captcha_challenge"?V(void 0):oe()}catch(se){ne(se)}};oe()});await Promise.race([ue,de]),b("event_shop_user_matched"),D?.current?.blur(),Yt(),d.current.abort(),h(void 0)}catch(b){if(b instanceof ht&&b.name==="AbortSignalReceivedError")return;b instanceof Error&&p(new Error(`Error updating user info: ${b.name} - ${b.message}`))}},[e,c,o,s,f,i,r,u,p,a,y,S]),B=pt((k,C,W)=>{N(k,C,W)},200);g(()=>{m!==void 0&&r&&B(m,P,v)},[B,m,r,P,v]),g(()=>{if(!t)return;const k=Q.querySelector(t);if(!k)return;D.current=k;const C=()=>{k&&h(k.value)};if(k?.value&&C(),!l){k?.removeEventListener("input",C);return}return k?.addEventListener("input",C),()=>{k?.removeEventListener("input",C)}},[t,l]),g(()=>{n!==void 0&&h(n)},[n]);const j=(k="",C="")=>{E(k),w(C)};return{getSubmittedEmail:L,updateEmailToPost:k=>h(k||""),updateNamesToPost:(k,C)=>j(k,C)}}function en({iframeRef:e}){const{loaded:n}=pe();async function t(o){if(!e.current)return;const{postMessage:s,waitForMessage:l}=e.current;n||await l("loaded"),s(o)}return{postMessageAfterLoad:t}}function tn(){const{analyticsData:e,produceMonorailEvent:n}=me();return{trackShopPayModalStateChange:I(({currentState:o,zoom:s})=>{const{analyticsTraceId:l,checkoutToken:c,checkoutVersion:r,shopPermanentDomain:u}=e,a={previousState:"",currentState:o,clientTimestampMs:new Date().getTime(),analyticsTraceId:l,checkoutToken:c||"",checkoutVersion:r||"",shopifyDomain:u||"",zoom:s};n({event:{payload:a,schemaId:"shopify_pay_modal_state_change/1.3"}})},[e,n])}}function nn(e){const{checkoutToken:n,checkoutVersion:t,shopPermanentDomain:o}=e;return{checkoutVersion:t,checkoutToken:n,flow:"checkout_modal",shopPermanentDomain:o}}const on=({anchorTo:e,email:n,queueToken:t,...o})=>{const{modalVisible:s}=pe(),l=M(null);Xt({email:n,iframeRef:l});const{postMessageAfterLoad:c}=en({iframeRef:l}),{trackUserAction:r}=me(),{leaveBreadcrumb:u}=Ve(),a=R(()=>({open:async()=>{s||(l.current?.open("user_button_clicked"),r({userAction:"OPEN_CALLED"}),u("open called",{},"state"))}}),[s,r,u]);Qt(a);const{trackShopPayModalStateChange:i}=tn(),p=I(()=>{i({currentState:"loaded",zoom:`${ke.visualViewport?.scale}`})},[i]),y=I(d=>{i({currentState:d?"shown":"hidden",zoom:`${ke.visualViewport?.scale}`})},[i]);g(()=>{t&&c({type:"checkoutqueuetokensubmitted",checkoutQueueToken:t})},[c,t]);const{authorizeUrl:f}=St({analyticsContext:"loginWithShopCheckoutModal",avoidSdkSession:!0,clientId:"",disableSignUp:!0,proxy:!0,redirectType:"iframe",responseType:"code",...o});return _(Et,{anchorTo:e,keepModalOpen:!0,onLoaded:p,onModalVisibleChange:y,proxy:!0,ref:l,src:f,variant:"checkoutModal"})},sn=()=>mt(({element:e,...n})=>_(yt,{element:e,monorailProps:nn(n),featureName:"ShopCheckoutModal",children:_(on,{...n})}),{methods:["open"],name:"shop-checkout-modal",props:{anchorTo:"string",checkoutRedirectUrl:"string",checkoutToken:"string",checkoutVersion:"string",email:"string",queueToken:"string",shopPermanentDomain:"string",transactionParams:"string"},shadow:"open"}),G=({shopCheckoutModal:e,eventName:n,eventListener:t})=>{g(()=>(e?.addEventListener(n,t),()=>e?.removeEventListener(n,t)),[t,n,e])};function rn({email:e,open:n,popoverActivator:t,showPopover:o,showToggle:s,onIframeLoaded:l}){const c=t?.current,r=M(null),[u,a]=A(!1),i=M(!1),{redirect_url:p,transaction_params:y}=Pe(),{myshopifyDomain:f}=ve(),d=fe(),{inMemoryPayPalParts:{accountStatus:m}}=Me(),{guestDismissedModalKey:h}=we(),{checkoutSessionIdentifier:P}=Z(),E=be().current.token;g(()=>{customElements.get("shop-checkout-modal")||sn()},[]);const v=Le(K.ShopPayVerification,{scope:Ae}),w=`${P}-${e.replace(/[^a-zA-Z0-9]/g,"")}`,D=De(),T=M(D);g(()=>{if(T.current){T.current=!1,a(!1);return}const k=sessionStorage.getItem(h),C=d&&le(w),W=m.peek().status==="connected";if(k||C||W){a(!1);return}if(v.peek()===F.Verified){v.value=void 0,a(!1);return}a(!0)},[e]);const S=I(()=>{he(),v.value=F.Verified,J.value="none"},[v]);G({shopCheckoutModal:r.current,eventName:"completed",eventListener:S});const L=I(()=>{if(!P)throw new ce("ShopPayCheckoutIdentifierMissingError::ShopJSVerification");$(ae,escape(P)),re(K.IdentifiedShopPayUser,escape(P)),window.dispatchEvent(new Event("shop_pay_user_identified_cookie_set")),v.value=F.Pending,o?.(!0,e),s?.(!1)},[P,e,v,o,s]);G({shopCheckoutModal:r.current,eventName:"modalopened",eventListener:L});const N=I(()=>{v.value=F.Dismissed,d&&$(w,"true"),o?.(!1),s?.(i.current)},[d,w,v,o,s]);G({shopCheckoutModal:r.current,eventName:"modalclosed",eventListener:N});const B=I(()=>{i.current=!0},[]);G({shopCheckoutModal:r.current,eventName:"shopusermatched",eventListener:B});const j=I(k=>{i.current=!1,$(ae,"false"),re(K.IdentifiedShopPayUser,"false"),window.dispatchEvent(new Event("shop_pay_user_identified_cookie_set"))},[]);return G({shopCheckoutModal:r.current,eventName:"shopusernotmatched",eventListener:j}),G({shopCheckoutModal:r.current,eventName:"loaded",eventListener:l}),g(()=>{const k=r.current;J.value=n?"shopPayVerification":"none",c&&n&&(k?.open(),c.blur())},[c,e,n]),p?_("shop-checkout-modal",{"anchor-to":c?.id?`#${c.id}`:"","checkout-redirect-url":p,"checkout-token":P,"checkout-version":"checkout_one",email:n||u?e:"","queue-token":E||"",ref:r,"shop-permanent-domain":f,"transaction-params":y}):null}const an=e=>_(Ie,{children:_(rn,{...e})}),ln=({email:e,onSetEmail:n,open:t,popoverActivator:o,showPopover:s,showToggle:l,urlOrigin:c=x.C1Modal,updatedOrigin:r=x.C1Modal})=>{const u=rt(),a=at(),i=R(()=>Ee(),[]),p=R(()=>Ee(),[]),y=M(!0),f=R(()=>{if(u!==void 0)return{isC1:!0,shopJsVerification:!u}},[u]);g(()=>{Y(e)&&(i.mark("start"),y.current=!0)},[i,e]),g(()=>{if(t&&y.current&&i.marks.start&&f){i.mark("open"),y.current=!1;const m=Math.round(i.marks.open-i.marks.start);a.histogram({name:"shop_pay_verification_time_to_interactive",value:m,attributes:f});const h=Math.round(i.marks.open-Math.max(i.marks.start,i.marks.loaded||0));a.histogram({name:"shop_pay_verification_time_to_interactive_after_load",value:h,attributes:f})}},[t,a,i,f]),g(()=>{p.mark("start")},[p]);const d=I(()=>{if(p.marks.start){p.mark("loaded"),i.mark("loaded");const m=Math.round(p.marks.loaded-p.marks.start);a.histogram({name:"shop_pay_verification_iframe_ready_duration",value:m,attributes:f})}},[p,i,a,f]);return u?_(jt,{popoverActivator:o,email:e,onSetEmail:n,open:t,showPopover:s,showToggle:l,urlOrigin:c,updatedOrigin:r,onIframeLoaded:d}):_(an,{popoverActivator:o,email:e,open:t,showPopover:s,showToggle:l,onIframeLoaded:d})};export{ln as default};
