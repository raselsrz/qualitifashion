import{q5 as E,dq as z,K as q,N as S,q6 as F,J as U,du as A,q7 as V,ae as k,aB as j,a as n,au as g,I as H,B as x,ar as D,al as P,bt as J,bs as K,x as h,D as Q,hB as b,z as f,at as Y,bE as G,az as W,i as X,aC as Z}from"./app.DCvXxO1S.js";const $={id:"76113fc688fe950e2e09d64b5b10df17007abf25436339310e6aeb706bdf5e30",type:"query",name:"PrivacyBannerSettings",source:"query PrivacyBannerSettings{privacyBannerSettings{autoManaged buttonAcceptText buttonDeclineText buttonPrefsOpenText enabled policyLinkText policyLinkUrl preferences{bulletPoints{enabled firstText secondText thirdText title __typename}buttonAcceptText buttonDeclineText buttonSaveText introText introTitle purposes{essentialDesc essentialName marketingDesc marketingName performanceDesc performanceName preferencesDesc preferencesName __typename}title __typename}text title consentTrackingApiToken showBannerOnCheckout __typename}}"},ee="privacy-consent-banner",B="privacy_preferences_modal",N=(e,s)=>{s?console.debug(s):e?console.error("Set consent error: ",e):console.error("Set consent error: unknown")},te=async(e,s)=>{await E({analytics:e,marketing:e,preferences:e,storefrontAccessToken:s},N)};var y=(e=>(e.Accept="accept",e.Decline="decline",e.AcceptAll="accept_all",e.DeclineAll="decline_all",e.ManagePreferences="manage_preferences",e.Save="save",e.LeavePreferences="leave_preferences",e.PrivacyPolicyView="privacy_policy_view",e.CloseCheckoutBanner="close_checkout_banner",e))(y||{});function M(){const e=z(),{domain:s,storefrontDomains:d}=q(),r=S(),o=r.searchParams.get("previewPrivacyBanner")==="true",{getCookie:c}=F(),l=U().checkoutSessionIdentifier,m=d.some(a=>document.referrer.includes(a));return{emitPrivacyBannerInteractionEvent:a=>{const C={schemaId:A.PrivacyBannerInteract,payload:{shopPermanentDomain:s,sessionToken:c("_shopify_y")||"0",regulation:"CMP",path:r.pathname,visitorRegion:V(),interactionType:a,checkoutSessionIdentifier:l,isStorefrontReferrer:m}};o||e.record(C)},emitPrivacyBannerRenderEvent:()=>{const a={schemaId:A.PrivacyBannerRender,payload:{shopPermanentDomain:s,sessionToken:c("_shopify_y")||"0",regulation:"CMP",path:r.pathname,checkoutSessionIdentifier:l,isStorefrontReferrer:m}};o||e.record(a)},emitPrivacyBannerInitializedEvent:()=>{const a={schemaId:A.PrivacyBannerInitialized,payload:{shopPermanentDomain:s,sessionToken:c("_shopify_y")||"0",regulation:"CMP",path:r.pathname,checkoutSessionIdentifier:l,isStorefrontReferrer:m}};o||e.record(a)}}}function ne(e){function s(){_(ee),_(B)}const[d,r]=k(!1),[o,c]=k(!1),[p,l]=k(!1),[m,T]=k(!0),{closeOverlay:_}=j(),{emitPrivacyBannerInteractionEvent:v}=M(),a=async({analytics:t,marketing:i,preferences:u})=>{r(t),c(i),l(u),await E({analytics:t,marketing:i,preferences:u,storefrontAccessToken:e.consentTrackingApiToken},N)},C=()=>{v(y.LeavePreferences),T(!0)},I=()=>{if(m){const{analytics:t,marketing:i,preferences:u}=W();r(t==="yes"),c(i==="yes"),l(u==="yes"),T(!1)}},O=n(H,{spacing:"large200",inlineAlignment:"start",children:[n(g,{kind:"secondary",onPress:()=>{a({analytics:!0,marketing:!0,preferences:!0}),v(y.AcceptAll),s()},children:e.buttonAcceptText}),n(g,{kind:"secondary",onPress:()=>{a({analytics:!1,marketing:!1,preferences:!1}),v(y.DeclineAll),s()},children:e.buttonDeclineText}),n(g,{onPress:()=>{a({analytics:d,marketing:o,preferences:p}),v(y.Save),s()},children:e.buttonSaveText})]}),L=(()=>{const t=[e.bulletPoints?.firstText,e.bulletPoints?.secondText,e.bulletPoints?.thirdText].filter(i=>typeof i=="string");return e.bulletPoints?.enabled&&t.length>0?n(Q,{children:[n(x,{spacing:"base"}),n(D,{level:3,children:e?.bulletPoints?.title}),n(P,{padding:["small300","none","small300","none"],children:n(J,{spacing:"tight",children:t.map((i,u)=>n(K,{children:n(h,{children:i})},u))})})]}):null})(),R=n(P,{spacing:"none",children:[n(D,{level:3,children:e.introTitle}),n(h,{children:e.introText}),L]}),w=n(P,{children:[n(b,{checked:!0,disabled:!0,children:[n(h,{children:n(f,{type:"strong",children:e.purposes.essentialName})}),e.purposes.essentialDesc]}),n(b,{checked:p,onChange:t=>l(t),children:[n(h,{children:n(f,{type:"strong",children:e.purposes.preferencesName})}),e.purposes.preferencesDesc]}),n(b,{checked:o,onChange:t=>c(t),children:[n(h,{children:n(f,{type:"strong",children:e.purposes.marketingName})}),e.purposes.marketingDesc]}),n(b,{checked:d,onChange:t=>r(t),children:[n(h,{children:n(f,{type:"strong",children:e.purposes.performanceName})}),e.purposes.performanceDesc]})]});return n(G,{id:B,title:e.title||"",primaryAction:O,size:"large",onClose:C,onOpen:I,children:[n(x,{spacing:"base"}),n(Y,{}),n(P,{padding:["base","large200","base","large200"],children:[R,w]})]})}function se({small:e}){const s=X(),{emitPrivacyBannerInteractionEvent:d}=M(),{data:r,loading:o,error:c}=Z($,{cache:!1});if(o||!r?.privacyBannerSettings?.enabled)return null;if(c||!r)return console.error("Error fetching consent banner data",c),null;const p=s("shop_policies.cookie_preferences","Cookie preferences");return n(g,{kind:"plain",onPress:()=>{d(y.ManagePreferences)},overlay:n(ne,{...r.privacyBannerSettings.preferences,consentTrackingApiToken:r.privacyBannerSettings.consentTrackingApiToken||void 0}),children:e?n(f,{size:"small",children:p}):p})}const ae=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"}));export{y as B,ae as F,ee as P,ne as a,$ as b,te as s,M as u};
